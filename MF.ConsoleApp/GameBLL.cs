using System;
using System.Collections.Generic;
using System.Configuration;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace MF.ConsoleApp
{
  public  class GameBLL
    {
        private static string chargeids = "";
        private static string filePath = ConfigurationManager.AppSettings["filePath"];
        private static int allCount = 0;
        private static int successCount = 0;
        private static void CheckAndAddBlack()
        {
            ReadFile();
            if (string.IsNullOrEmpty(chargeids))
            {
                Console.WriteLine("chargeids is empty.");
                return;
            }
            //2幺鸡 二七十  斗地主 二鬼 
            string[] chargeidList = chargeids.Split(',');
            allCount = chargeidList.Length * 5;
            while (successCount != allCount)
            {
                successCount = 0;
                CheckBalck();
            }
        }
        private static void CheckBalck()
        {
            try
            {
                //2幺鸡 二七十  斗地主 二鬼 
                string[] chargeidList = chargeids.Split(',');
                string[] gameIds = { "99861", "98861", "97761", "99561", "99761" };
                string[] values = { "-500, -300", "-500,-300", "-300,-200", "-1000,-600", "-5000,-3000" };
                string[] levelStr = { "HIGH", "HIGH", "HIGH", "HIGH", "HIGH" };
                string remark = "批量添加";
                for (int i = 0; i < chargeidList.Length; i++)
                {
                    for (int j = 0; j < gameIds.Length; j++)
                    {
                        List<GameBlackUserInfo> list = GameDAL.GetGameBlackUsers(int.Parse(gameIds[j]), "", chargeidList[i], 1);
                        string resStr = DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss ") + gameIds[j] + "---" + chargeidList[i] + "---- ";
                        if (list == null || list.Count < 1)
                        {
                            resStr += "isnot blackusr";
                            string[] strs = new string[] { gameIds[j] };
                            int res = GameDAL.AddBlackUser(new string[] { gameIds[j] },
                                chargeidList[i], new string[] { values[j] }, new string[] { levelStr[j] }, remark, 1);
                            resStr = "";
                            resStr = "adduser " + DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss ") + chargeidList[i];
                            if (res == 1)
                                Console.WriteLine(resStr + " success");
                            else Console.WriteLine(resStr + " fail:" + res.ToString());
                        }
                        else
                        {
                            resStr += "success";
                            successCount++;
                        }
                        Console.WriteLine(resStr);
                        Thread.Sleep(1000);
                    }
                }
                Console.WriteLine("chargeidlist is check all");
            }
            catch (Exception ex)
            {
                Console.WriteLine("addblackuserlist ex:" + ex.Message);
            }
            Console.WriteLine("addblackuserlist all is ok");
        }
        private static void AddBalck()
        {
            try
            {
                ReadFile();
                if (string.IsNullOrEmpty(chargeids))
                {
                    Console.WriteLine("chargeids is empty.");
                    return;
                }
                //2幺鸡 二七十  斗地主 二鬼 
                string[] gameIds = { "99861", "98861", "97761", "99561", "99761" };
                string[] values = { "-500, -300", "-500,-300", "-300,-200", "-1000,-600", "-5000,-3000" };
                string[] levelStr = { "HIGH", "HIGH", "HIGH", "HIGH", "HIGH" };
                string[] chargeidList = chargeids.Split(',');
                string remark = "批量添加";
                for (int i = 0; i < chargeidList.Length; i++)
                {
                    int res = GameDAL.AddBlackUser(gameIds, chargeidList[i], values, levelStr, remark, 1);
                    string resStr = DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss ") + chargeidList[i];
                    if (res == 1)
                        Console.WriteLine(resStr + " success");
                    else Console.WriteLine(resStr + " fail:" + res.ToString());
                    //Thread.Sleep(1000);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("addblackuserlist ex:" + ex.Message);
            }
            Console.WriteLine("addblackuserlist all is ok");
        }
        private static void ReadFile()
        {
            chargeids = "";
            // 创建一个 StreamReader 的实例来读取文件 
            // using 语句也能关闭 StreamReader
            using (StreamReader sr = new StreamReader(filePath))
            {
                string line;

                // 从文件读取并显示行，直到文件的末尾 
                while ((line = sr.ReadLine()) != null)
                {
                    chargeids += line;
                }
            }
            Console.WriteLine("chargeids:" + chargeids + " length:" + chargeids.Length.ToString());
        }
        private static void initData()
        {
            //    chargeids = @"10A000000214,10A000000243,10A000000258,10A000000268,10A000007390,10A000000270,10A000000224,10A000000316,10A000001041,10A000004237,10A000000251,10A000000256,10A000000312,10A000000352,10A000000365,10A000000245,10A000000363,10A000000428,10A000000427,10A000000426,10A000000467,10A000000429,10A000000470,10A000000528,10A000000261,10A000003900,10A000004006,10A000000539,10A000000552,10A000000305,10A000003899,10A000000369,10A000000667,10A000000693,10A000000704,10A000000214,10A000000258,10A000000737,10A000000768,10A000000774,10A000000824,10A000001245,10A000000859,10A000000866,10A000000303,10A000000913,10A000000924,10A000006721,10A000007084,10A000009561,10A000009595,10A000012827,10A000013693,10A000000745,10A000000746,10A000000526,10A000001041,10A000004237,10A000001043,10A000001046,10A000001415,10A000001063,10A000001070,10A000000612,10A000002464,10A000001144,10A000001141,10A000001135,10A000000343,10A000001188,10A000000337,10A000001202,10A000001207,10A000001230,10A000000411,10A000001321,10A000001246,10A000001325,10A000000841,10A000001372,10A000001391,10A000000898,10A000001420,10A000001500,10A000001939,10A000000243,10A000000258,10A000001437,10A000001942,10A000002577,10A000001145,10A000001563,10A000001598,10A000001498,10A000001515,10A000001552,10A000001741,10A000001746,10A000001396,10A000001288,10A000001816,10A000001719,10A000001804,10A000013162,10A000001363,10A000013162,10A000001879,10A000015897,10A000001873,10A000001984,10A000001840,10A000002072,10A000001795,10A000002167,10A000002170,10A000002411,10A000002412,10A000002084,10A000002102,10A000002091,10A000002094,10A000002122,10A000002136,10A000002167,10A000007042,10A000002170,10A000007049,10A000000249,10A000016045,10A000002189,10A000002412,10A000007039,10A000001654,10A000002411,10A000007048,10A000002205,10A000002219,10A000002271,10A000002306,10A000002297,10A000002326,10A000002329,10A000005874,10A000002348,10A000002302,10A000002375,10A000002339,10A000001604,10A000005874,10A000002407,10A000002478,10A000002507,10A000002511,10A000002516,10A000002523,10A000002528,10A000002528,10A000002567,10A000002603,10A000002612,10A000001740,10A000002636,10A000002648,10A000002701,10A000002709,10A000002718,10A000002773,10A000002760,10A000002531,10A000002532,10A000006751,10A000000637,10A000015260,10A000002820,10A000002830,10A000002903,10A000002909,10A000002950,10A000002949,10A000002960,10A000002928,10A000002984,10A000002440,10A000003082,10A000003145,10A000002899,10A000002774,10A000003184,10A000002883,10A000002960,10A000003279,10A000003301,10A000003324,10A000003353,10A000003376,10A000003386,10A000003394,10A000003407,10A000003367,10A000007526,10A000003449,10A000003504,10A000002867,10A000003552,10A000003608,10A000003528,10A000003620,10A000003647,10A000003648,10A000003690,10A000003726,10A000003741,10A000003769,10A000003806,10A000003451,10A000000566,10A000002488,10A000003901,10A000003913,10A000001880,10A000012838,10A000004077,10A000004463,10A000004126,10A000003914,10A000004942,10A000004199,10A000004244,10A000000287,10A000004287,10A000007033,10A000007108,10A000013694,10A000004300,10A000004359,10A000004328,10A000004317,10A000000371,10A000004382,10A000004437,10A000004449,10A000003716,10A000004481,10A000004521,10A000000550,10A000003718,10A000001137,10A000002809,10A000004566,10A000000571,10A000004656,10A000004666,10A000004516,10A000004672,10A000005413,10A000006905,10A000006948,10A000007033,10A000007034,10A000004694,10A000004684,10A000004706,10A000004568,10A000004710,10A000004735,10A000003054,10A000004752,10A000004682,10A000004733,10A000004801,10A000004796,10A000002750,10A000004864,10A000004904,10A000004804,10A000004926,10A000000824,10A000005016,10A000005480,10A000005039,10A000005048,10A000005093,10A000005050,10A000005052,10A000005205,10A000005218,10A000001714,10A000005230,10A000004945,10A000005400,10A000005401,10A000004399,10A000004488,10A000004490,10A000005473,10A000005505,10A000007929,10A000007930,10A000002354,10A000005505,10A000005295,10A000006086,10A000005591,10A000005709,10A000004377,10A000005732,10A000005648,10A000005492,10A000005754,10A000005764,10A000008591,10A000001806,10A000005805,10A000004119,10A000005866,10A000005827,10A000005982,10A000006056,10A000005411,10A000006115,10A000006124,10A000004928,10A000005985,10A000006148,10A000006187,10A000005942,10A000005973,10A000006217,10A000006220,10A000005874,10A000005942,10A000006102,10A000006340,10A000006350,10A000006357,10A000006382,10A000003691,10A000006425,10A000006485,10A000000472,10A000006537,10A000006539,10A000006558,10A000006561,10A000006565,10A000006586,10A000006411,10A000015281,10A000006605,10A000006610,10A000006620,10A000006635,10A000005747,10A000006246,10A000006670,10A000006692,10A000006704,10A000005761,10A000006797,10A000006808,10A000003690,10A000018725,10A000006808,10A000006811,10A000006779,10A000006822,10A000006879,10A000006859,10A000006936,10A000006508,10A000006966,10A000003901,10A000006993,10A000007009,10A000003847,10A000007036,10A000007038,10A000007051,10A000007055,10A000007087,10A000007089,10A000007094,10A000007105,10A000007077,10A000007057,10A000004424,10A000007084,10A000007135,10A000007197,10A000008063,10A000016898,10A000016911,10A000007070,10A000004580,10A000007302,10A000007306,10A000007299,10A000007324,10A000009603,10A000007235,10A000007346,10A000007358,10A000007367,10A000007362,10A000007406,10A000008251,10A000007417,10A000007351,10A000007404,10A000007463,10A000007491,10A000007400,10A000007497,10A000005155,10A000001220,10A000005524,10A000008248,10A000007470,10A000007529,10A000007539,10A000007540,10A000007544,10A000007557,10A000007197,10A000007565,10A000007569,10A000007432,10A000007600,10A000007602,10A000007618,10A000007411,10A000007414,10A000007474,10A000007650,10A000007667,10A000007695,10A000007699,10A000007704,10A000007698,10A000008787,10A000013573,10A000014193,10A000016167,10A000007709,10A000007712,10A000007727,10A000007567,10A000007756,10A000007738,10A000007742,10A000007791,10A000003421,10A000017686,10A000007862,10A000004273,10A000006947,10A000006721,10A000006731,10A000006906,10A000009208,10A000007881,10A000007732,10A000007897,10A000007898,10A000007896,10A000007913,10A000007820,10A000007937,10A000007953,10A000007974,10A000007833,10A000008001,10A000006969,10A000003221,10A000008057,10A000007706,10A000005508,10A000008124,10A000008155,10A000008158,10A000008161,10A000008168,10A000008169,10A000008170,10A000008187,10A000008182,10A000002058,10A000007892,10A000008226,10A000008229,10A000006053,10A000008274,10A000008301,10A000008306,10A000008317,10A000008329,10A000008390,10A000008394,10A000008415,10A000008446,10A000000463,10A000005518,10A000008530,10A000008564,10A000008578,10A000008601,10A000008612,10A000008616,10A000008403,10A000004369,10A000008642,10A000008649,10A000008658,10A000008667,10A000008679,10A000008685,10A000008703,10A000008710,10A000008728,10A000008737,10A000008736,10A000008740,10A000008695,10A000008752,10A000008787,10A000013573,10A000017871,10A000008799,10A000008782,10A000008805,10A000008830,10A000008831,10A000008850,10A000008857,10A000008864,10A000008866,10A000008901,10A000008492,10A000008950,10A000008955,10A000008964,10A000008972,10A000008997,10A000006357,10A000009046,10A000009122,10A000009064,10A000009070,10A000009090,10A000009095,10A000009099,10A000009100,10A000009146,10A000009171,10A000009221,10A000009230,10A000009307,10A000007405,10A000009254,10A000009260,10A000009224,10A000009283,10A000009296,10A000009302,10A000009315,10A000009360,10A000006680,10A000009371,10A000009378,10A000009387,10A000009397,10A000009354,10A000009446,10A000007568,10A000009436,10A000009494,10A000009500,10A000009515,10A000009530,10A000009546,10A000009529,10A000009539,10A000009596,10A000009612,10A000013705,10A000009627,10A000009660,10A000009599,10A000009223,10A000009722,10A000003899,10A000009259,10A000009757,10A000007985,10A000009770,10A000009718,10A000009774,10A000009016,10A000009854,10A000009872,10A000009793,10A000009931,10A000000472,10A000010022,10A000010082,10A000010100,10A000010147,10A000010270,10A000010185,10A000010091,10A000010281,10A000010261,10A000010269,10A000010272,10A000010350,10A000010410,10A000010414,10A000010432,10A000010429,10A000016029,10A000010444,10A000010489,10A000010520,10A000010532,10A000010566,10A000010620,10A000010614,10A000010681,10A000010687,10A000010679,10A000010702,10A000010712,10A000008776,10A000010782,10A000010792,10A000010823,10A000010781,10A000010864,10A000010868,10A000010882,10A000005533,10A000010945,10A000011038,10A000011061,10A000011092,10A000011103,10A000003066,10A000010388,10A000011012,10A000011084,10A000011221,10A000011241,10A000011326,10A000010956,10A000011368,10A000009354,10A000011373,10A000003225,10A000011396,10A000011416,10A000011496,10A000011558,10A000011398,10A000012348,10A000011594,10A000011640,10A000011671,10A000011683,10A000011700,10A000011705,10A000011718,10A000011740,10A000011778,10A000011802,10A000011812,10A000011843,10A000011302,10A000011860,10A000011868,10A000011883,10A000011897,10A000011939,10A000011954,10A000011874,10A000011983,10A000011997,10A000007452,10A000011917,10A000012080,10A000008714,10A000012120,10A000012136,10A000012181,10A000012187,10A000012252,10A000012251,10A000012268,10A000011705,10A000012194,10A000012296,10A000012388,10A000012370,10A000012383,10A000012408,10A000001144,10A000012437,10A000012434,10A000015911,10A000012468,10A000012480,10A000012472,10A000012482,10A000012501,10A000012563,10A000012571,10A000012615,10A000012617,10A000012632,10A000012652,10A000012656,10A000012677,10A000012689,10A000012096,10A000012709,10A000009073,10A000012748,10A000012756,10A000012772,10A000012761,10A000006626,10A000010683,10A000012771,10A000012823,10A000012850,10A000012952,10A000012348,10A000012982,10A000012998,10A000013026,10A000013057,10A000008497,10A000008575,10A000011520,10A000013082,10A000011739,10A000013183,10A000013207,10A000013281,10A000013307,10A000015732,10A000013308,10A000013330,10A000013323,10A000002950,10A000013411,10A000013459,10A000013450,10A000012810,10A000013302,10A000013565,10A000013577,10A000013599,10A000013615,10A000013317,10A000018610,10A000010143,10A000013675,10A000013688,10A000013389,10A000004275,10A000013711,10A000012129,10A000014492,10A000013744,10A000013659,10A000013602,10A000013819,10A000013824,10A000013834,10A000013848,10A000013867,10A000013882,10A000013906,10A000012246,10A000013913,10A000013947,10A000013907,10A000013981,10A000013988,10A000013931,10A000014034,10A000006125,10A000009748,10A000014109,10A000014112,10A000013655,10A000014164,10A000007528,10A000014203,10A000014259,10A000014284,10A000014335,10A000014367,10A000014395,10A000014239,10A000013711,10A000014436,10A000015209,10A000014444,10A000014459,10A000011076,10A000014476,10A000000634,10A000014491,10A000014498,10A000014517,10A000014519,10A000014552,10A000008831,10A000014221,10A000014699,10A000014703,10A000014746,10A000014749,10A000014752,10A000014097,10A000012480,10A000013317,10A000014748,10A000014856,10A000014864,10A000014888,10A000014902,10A000014905,10A000014923,10A000014939,10A000014958,10A000014987,10A000015011,10A000014920,10A000015067,10A000015091,10A000015110,10A000014902,10A000015125,10A000015126,10A000015032,10A000015168,10A000015148,10A000015155,10A000014886,10A000015149,10A000015193,10A000015200,10A000015205,10A000015227,10A000014702,10A000015255,10A000015313,10A000015640,10A000015333,10A000015361,10A000015392,10A000015403,10A000015326,10A000015409,10A000015441,10A000015451,10A000015453,10A000000637,10A000015260,10A000015479,10A000015487,10A000015489,10A000015501,10A000015503,10A000002058,10A000002704,10A000015604,10A000015647,10A000015653,10A000015675,10A000015725,10A000015713,10A000016939,10A000015734,10A000015757,10A000015759,10A000015769,10A000013307,10A000015732,10A000015791,10A000015799,10A000015825,10A000015822,10A000015834,10A000015831,10A000015610,10A000015951,10A000015875,10A000015899,10A000015921,10A000015942,10A000015431,10A000015964,10A000015962,10A000015968,10A000015882,10A000015981,10A000015988,10A000015992,10A000015957,10A000015917,10A000015603,10A000016005,10A000016034,10A000016050,10A000016053,10A000016054,10A000016061,10A000003665,10A000016078,10A000016099,10A000016110,10A000016134,10A000016155,10A000016164,10A000016195,10A000016029,10A000016183,10A000000249,10A000016045,10A000016242,10A000016260,10A000016264,10A000016265,10A000016276,10A000016322,10A000017446,10A000011983,10A000016358,10A000014937,10A000016346,10A000016400,10A000016421,10A000002909,10A000013872,10A000016489,10A000012733,10A000016497,10A000016506,10A000016545,10A000016553,10A000016559,10A000016562,10A000016581,10A000016623,10A000016628,10A000016673,10A000016663,10A000002503,10A000017597,10A000016710,10A000016711,10A000016726,10A000016743,10A000016745,10A000016609,10A000016779,10A000016789,10A000016792,10A000016793,10A000016815,10A000016816,10A000015487,10A000016832,10A000016835,10A000015822,10A000016849,10A000016850,10A000016855,10A000016862,10A000016870,10A000016909,10A000016926,10A000016928,10A000016946,10A000016952,10A000016960,10A000016963,10A000016962,10A000016987,10A000016993,10A000017016,10A000017074,10A000017074,10A000017091,10A000017076,10A000016881,10A000017121,10A000017140,10A000017139,10A000001740,10A000017153,10A000017169,10A000017181,10A000017214,10A000017228,10A000017232,10A000018592,10A000018972,10A000017238,10A000017276,10A000017281,10A000017294,10A000004915,10A000017348,10A000017404,10A000017357,10A000017359,10A000007820,10A000017393,10A000017404,10A000017424,10A000006125,10A000016916,10A000017440,10A000017458,10A000017475,10A000017484,10A000017488,10A000017490,10A000017495,10A000002704,10A000017509,10A000012251,10A000017535,10A000017536,10A000017538,10A000017556,10A000017565,10A000017564,10A000017596,10A000017601,10A000017587,10A000017605,10A000017615,10A000017622,10A000006355,10A000017661,10A000017680,10A000017697,10A000017022,10A000017720,10A000017726,10A000017778,10A000017785,10A000017792,10A000017799,10A000010725,10A000017726,10A000017820,10A000017821,10A000017825,10A000017839,10A000017852,10A000017872,10A000012714,10A000017889,10A000017895,10A000017921,10A000017948,10A000017953,10A000017921,10A000017816,10A000017986,10A000018004,10A000001288,10A000018026,10A000018032,10A000014702,10A000018039,10A000018067,10A000017919,10A000018078,10A000018111,10A000018126,10A000018163,10A000018161,10A000018168,10A000018174,10A000018176,10A000018188,10A000018218,10A000018227,10A000018224,10A000018251,10A000018252,10A000018264,10A000018269,10A000013382,10A000018302,10A000018304,10A000018265,10A000018308,10A000018319,10A000018348,10A000015921,10A000018360,10A000018358,10A000018362,10A000018376,10A000018396,10A000018400,10A000018402,10A000018408,10A000018406,10A000018415,10A000018437,10A000018443,10A000018469,10A000018479,10A000005754,10A000018517,10A000018525,10A000018531,10A000018536,10A000009627,10A000018582,10A000017460,10A000018609,10A000018635,10A000018646,10A000018656,10A000018669,10A000018671,10A000018677,10A000018711,10A000018742,10A000016939,10A000018784,10A000018806,10A000018831,10A000018844,10A000012761,10A000018859,10A000004926,10A000018992,10A000019039,10A000019003,10A000019074,10A000019119,10A000018396,10A000019143,10A000019170,10A000019181,10A000019169,10A000019199,10A000019218,10A000019298,10A000019332,10A000019338,10A000019346,10A000019210,10A000019435";
            chargeids = @"10A000015603,10A000016260,10A000011594,10A000019039,10A000005732,10A000017393,10A000002760,10A000016346," +
                "10A000002532,10A000006751,10A000000249,10A000000249,10A000013307,10A000013307,10A000004801,10A000007009," +
                "10A000007051,10A000007089,10A000012771,10A000009529,10A000018360,10A000018358,10A000000913,10A000000924," +
                "10A000006721,10A000007084,10A000009595,10A000012827,10A000013693,10A000007108,10A000013694,10A000004672," +
                "10A000005413,10A000006905,10A000006948,10A000007084,10A000004273,10A000006947,10A000006721,10A000006731," +
                "10A000006906,10A000009208,10A000008226,10A000008415,10A000010410,10A000010414,10A000004328,10A000007404," +
                "10A000002718,10A000012571,10A000015409,10A000013162,10A000013162,10A000002167,10A000002167,10A000007042," +
                "10A000007049,10A000015834,10A000015992,10A000017889,10A000018742,10A000012952,10A000006779,10A000002750," +
                "10A000004490,10A000014491,10A000005505,10A000005505,10A000009872,10A000015911,10A000008306,10A000008710," +
                "10A000008492,10A000010823,10A000014888,10A000014905,10A000015769,10A000015831,10A000015875,10A000016110," +
                "10A000014937,10A000016553,10A000017458,10A000017564,10A000017605,10A000017615,10A000017661,10A000017720," +
                "10A000017852,10A000017872,10A000017948,10A000017953,10A000018032,10A000018302,10A000018304,10A000018319," +
                "10A000018415,10A000018437,10A000018443,10A000018469,10A000018479,10A000018646,10A000018671,10A000018677," +
                "10A000018831,10A000019119,10A000019199,10A000016916,10A000018067,10A000015897,10A000003913,10A000008901," +
                "10A000003665,10A000017169,10A000012120,10A000008964,10A000002984,10A000015479,10A000006993,10A000016400," +
                "10A000016421,10A000002464,10A000001135,10A000015503,10A000006115,10A000016559,10A000018859,10A000009446," +
                "10A000015713";
        }
    }
}
